%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% DOCUMENT SETTINGS                   %%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[11pt,a4paper,sans]{moderncv}        
% font size ('10pt', '11pt' and '12pt'), 
% paper size ('a4paper', 'letterpaper', 'a5paper', 'legalpaper', 'executivepaper', 'landscape')
% font family ('sans' and 'roman')

\moderncvcolor{cerulean}                           
% color options 'black', 'blue' (default), 'burgundy', 'green', 'grey', 'orange', 'purple' and 'red'; for contemporary style use 'cerulean'

% moderncv themes
\moderncvstyle[]{contemporary}                     
% style options: 'casual' (default), 'classic', 'banking', 'oldstyle', 'fancy', 'contemporary'
% the 'contemporary' style optionally takes the `qr` (default) or `noqr` options+

%\renewcommand{\familydefault}{\sfdefault}         % to set the default font; use '\sfdefault' for the default sans serif font, '\rmdefault' for the default roman one, or any tex font name

%\nopagenumbers{}                                  
% uncomment to suppress automatic page numbering for CVs longer than one page

% adjust the page margins
\usepackage[hmargin=0.5in,vmargin=10pt]{geometry}                  
% the 'contemporary' style looks better with reduced margins; uncomment the line below for increased margin
%\usepackage[scale=0.75]{geometry}

%dates's column width
\setlength{\hintscolumnwidth}{2.8cm}

%\setlength{\listitemsymbolspace}{10pt}            % set custom spacing between list symbol and text item (influences \cvlistitem and \cvlistdoubleitem)

% the 'contemporary' style allows to append additional elements to the head background; uncomment and customize if needed
%\def\@moderncvheadBackground{
%}

% font loading
% for luatex and xetex, do not use inputenc and fontenc
\ifxetexorluatex
  \usepackage{fontspec}
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX}
  \setmainfont{Latin Modern Roman}
  \setsansfont{Latin Modern Sans}
  \setmonofont{Latin Modern Mono}
  \setmathfont{Latin Modern Math}
\else
  \usepackage[utf8]{inputenc}
  \usepackage[T1]{fontenc}
  \usepackage{lmodern}
\fi


%%%%%%%%%%%%%%%%%%%%%
%% Italian Version %%
%%%%%%%%%%%%%%%%%%%%%

% --- GESTIONE LINGUA (Step 1) ---
\ifdefined\makeitalian
  % Se è definita la variabile 'makeitalian', l'italiano è l'ultima lingua (Principale)
  \usepackage[english,italian]{babel}
\else
  % Altrimenti (Default), l'inglese è l'ultima lingua (Principale)
  \usepackage[italian,english]{babel}
\fi
% --------------------------------


%define commands to print only in a specific language; in text sections use \en{english text} or \it{italian text} to put different language version of same text
\newcommand{\en}[1]{\iflanguage{english}{#1}{}}   
\newcommand{\it}[1]{\iflanguage{italian}{#1}{}}

% --- CARICA IL PARSER LUA ---
\input{commons/lua_data_loader}  % <--- IMPORTANTE

% --- CARICA I DATI PERSONALI ---
\loadPersonalData       % <--- LEGGE DAL JSON
   
% --- FIX CHIUSURA LETTERA (Firma Calligrafica + Nome Stampatello) ---
\makeatletter
\renewcommand*{\makeletterclosing}{
  \@closing\\[1em]           % Spazio dopo "Yours faithfully,"
  
  % 1. FIRMA FINTA (Font Calligra)
  {\huge\calligra \@firstname~\@familyname}\\[0.5em] 
  
  % 2. NOME LEGGIBILE (Stampatello Grassetto)
  {\bfseries \@firstname~\@familyname}%
}
\makeatother
% --------------------------------------------------------------------

\begin{document}

% --- CORPO DELLA LETTERA ---
% recipient data
\recipient{Company Recruitment team}{Company, Inc.\\123 somestreet\\some city}
\date{January 01, 1984}
\subject{Job application}
\opening{Dear Sir or Madam,}
\closing{Yours faithfully,}

%\signature{}{<path>} % first argument goes to \includegraphics > scale
\enclosure[Attached]{curriculum vit\ae{}}          
\makelettertitle

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis ullamcorper neque sit amet lectus facilisis sed luctus nisl iaculis. Vivamus at neque arcu, sed tempor quam. Curabitur pharetra tincidunt tincidunt. Morbi volutpat feugiat mauris, quis tempor neque vehicula volutpat. Duis tristique justo vel massa fermentum accumsan. Mauris ante elit, feugiat vestibulum tempor eget, eleifend ac ipsum. Donec scelerisque lobortis ipsum eu vestibulum. Pellentesque vel massa at felis accumsan rhoncus.

Suspendisse commodo, massa eu congue tincidunt, elit mauris pellentesque orci, cursus tempor odio nisl euismod augue. Aliquam adipiscing nibh ut odio sodales et pulvinar tortor laoreet. Mauris a accumsan ligula. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Suspendisse vulputate sem vehicula ipsum various nec tempus dui dapibus. Phasellus et est urna, ut auctor erat. Sed tincidunt odio id odio aliquam mattis. Donec sapien nulla, feugiat eget adipiscing sit amet, lacinia ut dolor. Phasellus tincidunt, leo a fringilla consectetur, felis diam aliquam urna, vitae aliquet lectus orci nec velit. Vivamus dapibus various blandit.

Duis sit amet magna ante, at sodales diam. Aenean consectetur porta risus et sagittis. Ut interdum, enim various pellentesque tincidunt, magna libero sodales tortor, ut fermentum nunc metus a ante. Vivamus odio leo, tincidunt eu luctus ut, sollicitudin sit amet metus. Nunc sed orci lectus. Ut sodales magna sed velit volutpat sit amet pulvinar diam venenatis.

Albert Einstein discovered that $e=mc^2$ in 1905.

\[ e=\lim_{n \to \infty} \left(1+\frac{1}{n}\right)^n \]

\makeletterclosing


\end{document}